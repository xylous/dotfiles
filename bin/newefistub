#!/bin/bash

declare lts=''
declare label="Arch Linux"
if [[ $1 == 'lts' ]]; then
    lts='-lts'
    label="Arch Linux LTS"
fi

readonly disk="/dev/nvme0n1"
readonly part="1"
declare kernel_parameters="root=${disk}p2 rw "
kernel_parameters+='quiet acpi_backlight=vendor vga=current loglevel=3 '
kernel_parameters+='udev.log_level=3 vt.global_cursor_default=0 '
kernel_parameters+="initrd=\amd-ucode.img initrd=\initramfs-linux${lts}.img"

efibootmgr \
    --disk "${disk}" \
    --part "${part}" \
    --create \
    --label "${label}" \
    --loader /vmlinuz-linux-lts \
    --unicode "${kernel_parameters}" \
    --verbose
