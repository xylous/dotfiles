#!/usr/bin/sh

# initialise a new repository, with a LICENSE and README template

# Copy template README license file into new repo and edit it
function init_readme()
{
    cp "${XDG_CONFIG_HOME}/git/README_template.md" "README.md"

    $EDITOR "README.md"
}

# Copy template LICENSE file into new repo and change placeholders
function init_license()
{
    local year="$(date +%Y)"
    local user_name="$(git config --global --get user.name)"
    local user_email="$(git config --global --get user.email)"

    cp "${XDG_CONFIG_HOME}/git/MIT_license_template" "LICENSE"

    # Replace placeholder fields, i.e. [year] with the current year and
    # [fullname] with the value of `user.name` set in gitconfig
    sed -e "s/\[year\]/${year}/" \
        -e "s/\[fullname\]/${user_name}/" \
        -e "s/\[email\]/${user_email}/" \
        -i "LICENSE"
}

init_license
init_readme
git init
